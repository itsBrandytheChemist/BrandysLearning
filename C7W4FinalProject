#ui.R plan

# Import libraries
library(shiny)
library(tidyverse)


#Title & opening code
shinyUI(fluidPage(
  titlePanel(title="Trends in Demographics and Income"),
  p("Explore the difference between people who earn less than 50k and more than 50k. You can filter the data by country, then explore various demographic information."),
  
  #fluidRow() layout
  #row1: col width 12, Country select from dropdown menu
  fluidRow(
    column(12, wellPanel(
      selectInput(inputId = "i_country", 
                  label = "Select a country to start",
                  choices = c("United-States", "Canada", "Mexico", "Germany", "Philippines"),
                  selected = "United-States")))),
  fluidRow(
    column(3, wellPanel(
      p("Select a continuous variable and graph type to view on the right"),
      radioButtons(inputId="i_contvar",
                   label="Continuous variable:",
                   choices = c("age", "hours_per_week"),
                   select="age"),
      radioButtons(inputId="i_graph",
                   label="Graph type:",
                   choices = c("Boxplot", "Histogram"),
                   select="Boxplot"))),
    column(9, plotOutput("p1"))),
  fluidRow(
    column(3, wellPanel(
      p("Select a categorical variable to view bar chart on the right. Use the stacked bar checkbox to combine the income levels into one bar."),
      radioButtons(inputId="i_catvar",
                   label = "Categorical variable:",
                   choices = c("education", "workclass", "sex"),
                   select="education"),
      checkboxInput(inputId="i_stack", 
                    label = "Stacked bar graph?",
                    value=FALSE)
    )),
    column(9, plotOutput("p2"))
  )
))



#server.R plan



# Import libraries
library(shiny)
library(ggplot2)

# Set up dataframe and variables
censusdf <- read_csv("adult.csv")
names(censusdf) <- tolower(names(censusdf))

shinyserver(function(input,output) {

census_by_country <- reactive({
    censusdf %>% filter(native_country == input$i_country)
  })

    output$p1 <- renderPlot({
        if(input$i_graph == "Boxplot"){
            ggplot(censusdf, 
                aes(y=factor(!!input$i_contvar))+
                geom_boxplot()+
                labs(title=paste("Trend of", input$i_contvar))+
                coord_flip()+
                facet_wrap(~pred))
        } else {
            ggplot(censusdf, 
                aes(x=factor(!!input$i_contvar))+
                geom_histogram()+
                labs(title=paste("Trend of", input$i_contvar))+
                facet_wrap(~pred))
        }
    })
    output$p2 <- renderPlot({
        if(input$i_stack == FALSE){
            ggplot(censusdf, 
                aes(x="get this from instructions",
                    y= !!input$i_catvar,
                    fill= "get this from instructions))+
                geom_bar(position="dodge")+
                labs(title=paste("Trend of", input$i_catvar))+
                facet_wrap(~pred))
        } else {
            ggplot(censusdf,
                aes(x="", 
                    fill="get this from instructions"))+
                geom_bar(position="stack")+
                labs(title=paste("Trend of", input$i_catvar))+
                facet_wrap(~pred)
        }
    })
})

