#ui.R plan

# Import libraries
library(shiny)
library(tidyverse)

# Set up dataframe and variables
censusdf <- read_csv("adult.csv")
cont_var <- c("age", "hours_per_week")

#Title & opening code
shinyUI(fluidpage(
titlePanel(title="Trends in Demographics and Income"),
p("Explore the difference between people who earn less than 50k and more than 50k. You can filter the data by country, then explore various demographic information."),

#fluidRow() layout
    #row1: col width 12, Country select from dropdown menu
fluidRow(
    column(12, wellPanel(
        selectInput("i_country", "Select a country to start",
            choices = c("United States", "Canada", "Mexico", "Germany", "Philippines"),
            selected = "United States")))),
fluidRow(
    column(3, wellPanel(
        p("Select a continuous variable and graph type to view on the right"),
        radioButtons(inputId="i_contvar",
            label="Continuous variable:",
            choices = select(censusdf, cont_var)),
        radioButtons(inputId="i_graph",
            label="Graph type:",
            choices = c("boxplot", "histogram")))),
    column(9, 
        if(input$i_graph == "boxplot"){
            plotOutput("p1")
        } else {
            plotOutput("p2")
        }
        )
fluidRow(
    column(3, wellPanel(
        p("Select a categorical variable to view bar chart on the right. Use the stacked bar checkbox to combine the income levels into one bar."),
        radioButtons(inputId="i_catvar",
            label = "Categorical variable:",
            choices = select(censusdf, -cont_var))
        checkboxInput("i_stack", "Stack bars"))),
    column(9, 
        if(input$i_stack == TRUE){
            plotOutput("p4")
        } else {
            plotOutput("p3")
        }
        ))




#server.R plan

#how to filter by country, test plot
ggplot(censusdf$country, 
            aes(y=factor(!!input$i_contvar))+
            geom_boxplot()+
            labs(title=paste("Trend of", input$i_contvar))+
            coord_flip()+
            facet_wrap(~pred))

# Import libraries
library(shiny)
library(ggplot2)

shinyserver(function(input,output) {
    output$p1 <- renderPlot({
        ggplot(censusdf, 
            aes(y=factor(!!input$i_contvar))+
            geom_boxplot()+
            labs(title=paste("Trend of", input$i_contvar))+
            coord_flip()+
            facet_wrap(~pred))
    })
    output$p2 <- renderPlot({
        ggplot(censusdf, 
            aes(x=factor(!!input$i_contvar))+
            geom_histogram()+
            labs(title=paste("Trend of", input$i_contvar))+
            facet_wrap(~pred))
    })
    output$p3 <- renderPlot({
        ggplot(censusdf, 
            aes(x="get this from instructions",
                y= !!input$i_catvar,
                fill= "get this from instructions))+
            geom_bar(position="dodge")+
            labs(title=paste("Trend of", input$i_catvar))+
            facet_wrap(~pred))
    })
    output$p4 <- renderPlot({
        ggplot(censusdf,
        aes(x="", fill="get this from instructions"))+
        geom_bar(position="stack")+
        labs(title=paste("Trend of", input$i_catvar))+
            facet_wrap(~pred))
    })
})

